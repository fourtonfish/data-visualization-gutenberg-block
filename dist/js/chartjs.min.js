"use strict";function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var a=[],r=!0,o=!1,s=void 0;try{for(var n,l=t[Symbol.iterator]();!(r=(n=l.next()).done)&&(a.push(n.value),!e||a.length!==e);r=!0);}catch(t){o=!0,s=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw s}}return a}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function ready(t){"loading"!=document.readyState?t():document.addEventListener("DOMContentLoaded",t)}window.ftfHelpers=window.ftfHelpers||{},ftfHelpers.isMobile=function(){var t,e=!1;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e},ftfHelpers.convertHex=function(t,e){return t=(t=t||"#000000").replace("#",""),"rgba("+parseInt(t.substring(0,2),16)+","+parseInt(t.substring(2,4),16)+","+parseInt(t.substring(4,6),16)+","+e/100+")"},ftfHelpers.pSBC=function(t,e,a,r){var o,s,n,l,i,c,d,f=parseInt,p=Math.round,u="string"==typeof a;return"number"!=typeof t||t<-1||1<t||"string"!=typeof e||"r"!=e[0]&&"#"!=e[0]||a&&!u?null:(this.pSBCr||(this.pSBCr=function(t){var e=t.length,a={};if(9<e){var r=_slicedToArray(t=t.split(","),4);if(o=r[0],s=r[1],n=r[2],u=r[3],(e=t.length)<3||4<e)return null;a.r=f("a"==o[3]?o.slice(5):o.slice(4)),a.g=f(s),a.b=f(n),a.a=u?parseFloat(u):-1}else{if(8==e||6==e||e<4)return null;e<6&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+(4<e?t[4]+t[4]:"")),t=f(t.slice(1),16),9==e||5==e?(a.r=t>>24&255,a.g=t>>16&255,a.b=t>>8&255,a.a=p((255&t)/.255)/1e3):(a.r=t>>16,a.g=t>>8&255,a.b=255&t,a.a=-1)}return a}),d=9<e.length,d=u?9<a.length||"c"==a&&!d:d,i=this.pSBCr(e),l=t<0,c=a&&"c"!=a?this.pSBCr(a):l?{r:0,g:0,b:0,a:-1}:{r:255,g:255,b:255,a:-1},l=1-(t=l?-1*t:t),i&&c?(n=r?(o=p(l*i.r+t*c.r),s=p(l*i.g+t*c.g),p(l*i.b+t*c.b)):(o=p(Math.pow(l*Math.pow(i.r,2)+t*Math.pow(c.r,2),.5)),s=p(Math.pow(l*Math.pow(i.g,2)+t*Math.pow(c.g,2),.5)),p(Math.pow(l*Math.pow(i.b,2)+t*Math.pow(c.b,2),.5))),u=i.a,c=c.a,u=(i=0<=u||0<=c)?u<0?c:c<0?u:u*l+c*t:0,d?"rgb"+(i?"a(":"(")+o+","+s+","+n+(i?","+p(1e3*u)/1e3:"")+")":"#"+(4294967296+16777216*o+65536*s+256*n+(i?p(255*u):0)).toString(16).slice(1,i?void 0:-2)):null)},ftfHelpers.invertColor=function(t,e){0===t.indexOf("#")&&(t=t.slice(1)),3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var a=parseInt(t.slice(0,2),16),r=parseInt(t.slice(2,4),16),o=parseInt(t.slice(4,6),16);return e?186<.299*a+.587*r+.114*o?"#000000":"#FFFFFF":(a=(255-a).toString(16),r=(255-r).toString(16),o=(255-o).toString(16),"#"+ftfHelpers.padZero(a)+ftfHelpers.padZero(r)+ftfHelpers.padZero(o))},ftfHelpers.padZero=function(t,e){return e=e||2,(new Array(e).join("0")+t).slice(-e)},ftfHelpers.renderChart=function(s){if(!s)return!1;var e,n=s.dataset.type||"bar",l=s.dataset.sort&&"true"===s.dataset.sort?(e=JSON.parse(JSON.stringify(window.ftfDataviz[parseInt(s.dataset.sourceId)].data_labels_sorted)),JSON.parse(JSON.stringify(window.ftfDataviz[parseInt(s.dataset.sourceId)].data_series_sorted))):(e=JSON.parse(JSON.stringify(window.ftfDataviz[parseInt(s.dataset.sourceId)].data_labels)),JSON.parse(JSON.stringify(window.ftfDataviz[parseInt(s.dataset.sourceId)].data_series)));s.dataset.ignoreNull&&"true"===s.dataset.ignoreNull&&(l.forEach(function(t,a){var r=!0;t.forEach(function(t,e){l[a][e]&&0!==parseInt(l[a][e])&&(r=!1)}),r&&(delete l[a],delete e[a])}),l=l.filter(function(t){return null!=t}),e=e.filter(function(t){return null!=t})),s.dataset.sort&&"true"===s.dataset.sort&&s.dataset.limit&&(e=e.slice(0,s.dataset.limit),l=l.slice(0,s.dataset.limit)),3<l.length&&l.length;for(var i=l[0].length,c=[],t=0;t<i;t++)!function(a){var r=[],o="";l.forEach(function(t,e){o=window.ftfDataviz[parseInt(s.dataset.sourceId)].axis_label_values[a],r.push(l[e][a])});var t={label:o,data:r,__custom_meta:{prefix:s.dataset.prefix,suffix:s.dataset.suffix}};s.dataset.colorScheme&&ftfHelpers.colorPalettes[s.dataset.colorScheme]&&(-1!==["bar","horizontalBar"].indexOf(n)?t.backgroundColor=ftfHelpers.colorPalettes[s.dataset.colorScheme][i+3][a]:"line"===n&&(t.borderColor=ftfHelpers.colorPalettes[s.dataset.colorScheme][i+3][a],t.fill=!1)),c.push(t)}(t);if(s.dataset.columnFilter&&"true"===s.dataset.columnFilter){console.log("datasets",c);for(var a=1;a<c.length;a++){console.log("data map",c[a]);var r="<label>".concat(c[a].label,'\n                <select name="ftf-dataviz-filter-').concat(s.dataset.sourceId,'" id="ftf-dataviz-filter-').concat(s.dataset.sourceId,'">\n                  ').concat(c[a].data.map(function(t){return console.log("data map",t),'<option value="option">option</option>'}),"\n                </select>\n            </label>");console.log("dataset "+a,c[a]),console.log("selectHtml",r)}c=[c[0]]}var o={type:n,data:{labels:e,datasets:c},options:{}};switch(n){case"horizontalBar":case"bar":case"line":var d=[{scaleLabel:{display:!0,labelString:window.ftfDataviz[parseInt(s.dataset.sourceId)].axis_label_title},ticks:{beginAtZero:!0}}],f=[{scaleLabel:{display:!0,labelString:s.dataset.label},type:s.dataset.logScale?"logarithmic":"linear",ticks:{beginAtZero:!0,userCallback:function(t){return s.dataset.prefix+t.toLocaleString()+s.dataset.suffix}}}];s.dataset.logScale&&4<l.length&&(f[0].ticks.maxTicksLimit=l.length),ftfHelpers.isAdmin()&&(f[0].ticks.maxTicksLimit=4),"horizontalBar"===n?(o.options.scales={xAxes:f,yAxes:d},o.options.tooltips={callbacks:{label:function(t,e){return e.datasets[0].__custom_meta.prefix+t.xLabel.toLocaleString()+e.datasets[0].__custom_meta.suffix}}}):(o.options.scales={xAxes:d,yAxes:f},o.options.tooltips={callbacks:{title:function(t,e){return e.datasets[t[0].datasetIndex].label},label:function(t,e){return"".concat(e.labels[t.index],": ").concat(e.datasets[0].__custom_meta.prefix).concat(t.yLabel.toLocaleString()).concat(e.datasets[0].__custom_meta.suffix)}}}),o.options.responsive=!0,ftfHelpers.colorPalettes[s.dataset.colorScheme]&&o.data.datasets.forEach(function(t,e){t.hoverBorderWidth=4,t.hoverBorderColor=ftfHelpers.pSBC(-.05,ftfHelpers.invertColor(ftfHelpers.colorPalettes[s.dataset.colorScheme][i+3][e])),t.borderWidth=4});break;case"pie":case"doughnut":case"polarArea":for(var p,u=0;u<i;u++){o.data&&o.data.datasets[u]&&(p=void 0,p=ftfHelpers.colorPalettes[s.dataset.colorScheme][e.length]?ftfHelpers.colorPalettes[s.dataset.colorScheme][e.length]:ftfHelpers.colorPalettes[s.dataset.colorScheme][Object.keys(ftfHelpers.colorPalettes[s.dataset.colorScheme]).length-3],o.data.datasets[u].backgroundColor=p,o.data.datasets[u].hoverBorderColor=p.map(function(t){return ftfHelpers.pSBC(-.05,ftfHelpers.invertColor(t))}),o.data.datasets[u].hoverBorderWidth=4,o.data.datasets[u].borderWidth=4)}o.options.tooltips={callbacks:{title:function(t,e){return e.labels[t[0].index]},label:function(t,e){return e.datasets[0].__custom_meta.prefix+parseInt(e.datasets[0].data[t.index]).toLocaleString()+e.datasets[0].__custom_meta.suffix}}};break;case"radar":for(var m,b=0;b<i;b++){o.data&&o.data.datasets[b]&&(m=void 0,m=ftfHelpers.colorPalettes[s.dataset.colorScheme][i]?ftfHelpers.colorPalettes[s.dataset.colorScheme][i]:ftfHelpers.colorPalettes[s.dataset.colorScheme][Object.keys(ftfHelpers.colorPalettes[s.dataset.colorScheme]).length-3],o.data.datasets[b].backgroundColor=ftfHelpers.convertHex(m[b],20),o.data.datasets[b].borderColor=ftfHelpers.convertHex(m[b],40),o.data.datasets[b].hoverBorderColor=ftfHelpers.convertHex(ftfHelpers.pSBC(-.05,ftfHelpers.invertColor(m[b])),40),o.data.datasets[b].hoverBorderWidth=4,o.data.datasets[b].borderWidth=4)}o.options.tooltips={callbacks:{title:function(t,e){return e.labels[t[0].index]},label:function(t,e){return e.datasets[0].__custom_meta.prefix+parseInt(e.datasets[0].data[t.index]).toLocaleString()+e.datasets[0].__custom_meta.suffix}}}}console.log("chartEl",s),ftfHelpers.isMobile()&&(s.height=s.width);var g,h,v,y,w,S=new Chart(s,o);ftfHelpers.isAdmin()||(g=function(){-1<y&&w.controller.removeHoverStyle(w.data[y],0,y)},h=function(){w.controller.setHoverStyle(w.data[y],0,y),S.render()},v=function(){g(),y=(y+1)%w.data.length,h()},y=-1,w=S.getDatasetMeta(0),s.addEventListener("focus",function(){(-1===y?v:h)()}),s.addEventListener("blur",function(){g(),S.render()}),s.addEventListener("keydown",function(t){"ArrowRight"===t.key?v():"ArrowLeft"===t.key&&(g(),y=(y||w.data.length)-1,h())}))},ftfHelpers.isAdmin=function(){var t=document.getElementsByClassName("wp-admin");return t&&t.length},ready(function(){var t=document.getElementsByClassName("ftf-dataviz-chart");Array.from(t).forEach(function(t){ftfHelpers.renderChart(t)})});
//# sourceMappingURL=chartjs.min.js.map
