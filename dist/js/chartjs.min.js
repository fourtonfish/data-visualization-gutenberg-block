"use strict";function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var a=[],r=!0,o=!1,s=void 0;try{for(var n,l=t[Symbol.iterator]();!(r=(n=l.next()).done)&&(a.push(n.value),!e||a.length!==e);r=!0);}catch(t){o=!0,s=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw s}}return a}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function ready(t){"loading"!=document.readyState?t():document.addEventListener("DOMContentLoaded",t)}window.ftfHelpers=window.ftfHelpers||{},ftfHelpers.convertHex=function(t,e){return t=(t=t||"#000000").replace("#",""),"rgba("+parseInt(t.substring(0,2),16)+","+parseInt(t.substring(2,4),16)+","+parseInt(t.substring(4,6),16)+","+e/100+")"},ftfHelpers.pSBC=function(t,e,a,r){var o,s,n,l,i,c,d,f=parseInt,u=Math.round,p="string"==typeof a;return"number"!=typeof t||t<-1||1<t||"string"!=typeof e||"r"!=e[0]&&"#"!=e[0]||a&&!p?null:(this.pSBCr||(this.pSBCr=function(t){var e=t.length,a={};if(9<e){var r=_slicedToArray(t=t.split(","),4);if(o=r[0],s=r[1],n=r[2],p=r[3],(e=t.length)<3||4<e)return null;a.r=f("a"==o[3]?o.slice(5):o.slice(4)),a.g=f(s),a.b=f(n),a.a=p?parseFloat(p):-1}else{if(8==e||6==e||e<4)return null;e<6&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+(4<e?t[4]+t[4]:"")),t=f(t.slice(1),16),9==e||5==e?(a.r=t>>24&255,a.g=t>>16&255,a.b=t>>8&255,a.a=u((255&t)/.255)/1e3):(a.r=t>>16,a.g=t>>8&255,a.b=255&t,a.a=-1)}return a}),d=9<e.length,d=p?9<a.length||"c"==a&&!d:d,i=this.pSBCr(e),l=t<0,c=a&&"c"!=a?this.pSBCr(a):l?{r:0,g:0,b:0,a:-1}:{r:255,g:255,b:255,a:-1},l=1-(t=l?-1*t:t),i&&c?(n=r?(o=u(l*i.r+t*c.r),s=u(l*i.g+t*c.g),u(l*i.b+t*c.b)):(o=u(Math.pow(l*Math.pow(i.r,2)+t*Math.pow(c.r,2),.5)),s=u(Math.pow(l*Math.pow(i.g,2)+t*Math.pow(c.g,2),.5)),u(Math.pow(l*Math.pow(i.b,2)+t*Math.pow(c.b,2),.5))),p=i.a,c=c.a,p=(i=0<=p||0<=c)?p<0?c:c<0?p:p*l+c*t:0,d?"rgb"+(i?"a(":"(")+o+","+s+","+n+(i?","+u(1e3*p)/1e3:"")+")":"#"+(4294967296+16777216*o+65536*s+256*n+(i?u(255*p):0)).toString(16).slice(1,i?void 0:-2)):null)},ftfHelpers.invertColor=function(t,e){0===t.indexOf("#")&&(t=t.slice(1)),3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var a=parseInt(t.slice(0,2),16),r=parseInt(t.slice(2,4),16),o=parseInt(t.slice(4,6),16);return e?186<.299*a+.587*r+.114*o?"#000000":"#FFFFFF":(a=(255-a).toString(16),r=(255-r).toString(16),o=(255-o).toString(16),"#"+ftfHelpers.padZero(a)+ftfHelpers.padZero(r)+ftfHelpers.padZero(o))},ftfHelpers.padZero=function(t,e){return e=e||2,(new Array(e).join("0")+t).slice(-e)},ftfHelpers.renderChart=function(s){if(!s)return!1;var e,n=s.dataset.type||"bar",l=s.dataset.sort&&"true"===s.dataset.sort?(e=JSON.parse(JSON.stringify(window.ftfDataviz[parseInt(s.dataset.sourceId)].data_labels_sorted)),JSON.parse(JSON.stringify(window.ftfDataviz[parseInt(s.dataset.sourceId)].data_series_sorted))):(e=JSON.parse(JSON.stringify(window.ftfDataviz[parseInt(s.dataset.sourceId)].data_labels)),JSON.parse(JSON.stringify(window.ftfDataviz[parseInt(s.dataset.sourceId)].data_series)));s.dataset.ignoreNull&&"true"===s.dataset.ignoreNull&&(l.forEach(function(t,a){var r=!0;t.forEach(function(t,e){l[a][e]&&0!==parseInt(l[a][e])&&(r=!1)}),r&&(delete l[a],delete e[a])}),l=l.filter(function(t){return null!=t}),e=e.filter(function(t){return null!=t})),s.dataset.sort&&"true"===s.dataset.sort&&s.dataset.limit&&(e=e.slice(0,s.dataset.limit),l=l.slice(0,s.dataset.limit)),3<l.length&&l.length;for(var i=l[0].length,c=[],t=0;t<i;t++)!function(a){var r=[],o="";l.forEach(function(t,e){o=window.ftfDataviz[parseInt(s.dataset.sourceId)].axis_label_values[a],r.push(l[e][a])});var t={label:o,data:r,__custom_meta:{prefix:s.dataset.prefix,suffix:s.dataset.suffix}};s.dataset.colorScheme&&ftfHelpers.colorPalettes[s.dataset.colorScheme]&&(-1!==["bar","horizontalBar"].indexOf(n)?t.backgroundColor=ftfHelpers.colorPalettes[s.dataset.colorScheme][i+3][a]:"line"===n&&(t.borderColor=ftfHelpers.colorPalettes[s.dataset.colorScheme][i+3][a],t.fill=!1)),c.push(t)}(t);if(s.dataset.columnFilter&&"true"===s.dataset.columnFilter){console.log("datasets",c);for(var a=1;a<c.length;a++){console.log("data map",c[a]);var r="<label>".concat(c[a].label,'\n                <select name="ftf-dataviz-filter-').concat(s.dataset.sourceId,'" id="ftf-dataviz-filter-').concat(s.dataset.sourceId,'">\n                  ').concat(c[a].data.map(function(t){return console.log("data map",t),'<option value="option">option</option>'}),"\n                </select>\n            </label>");console.log("dataset "+a,c[a]),console.log("selectHtml",r)}c=[c[0]]}var o={type:n,data:{labels:e,datasets:c},options:{}};switch(n){case"horizontalBar":case"bar":case"line":var d=[{scaleLabel:{display:!0,labelString:window.ftfDataviz[parseInt(s.dataset.sourceId)].axis_label_title},ticks:{beginAtZero:!0}}],f=[{scaleLabel:{display:!0,labelString:s.dataset.label},type:s.dataset.logScale?"logarithmic":"linear",ticks:{beginAtZero:!0,userCallback:function(t){return s.dataset.prefix+t.toLocaleString()+s.dataset.suffix}}}];s.dataset.logScale&&4<l.length&&(f[0].ticks.maxTicksLimit=l.length),ftfHelpers.isAdmin()&&(f[0].ticks.maxTicksLimit=4),"horizontalBar"===n?(o.options.scales={xAxes:f,yAxes:d},o.options.tooltips={callbacks:{label:function(t,e){return e.datasets[0].__custom_meta.prefix+t.xLabel.toLocaleString()+e.datasets[0].__custom_meta.suffix}}}):(o.options.scales={xAxes:d,yAxes:f},o.options.tooltips={callbacks:{title:function(t,e){return e.datasets[t[0].datasetIndex].label},label:function(t,e){return"".concat(e.labels[t.index],": ").concat(e.datasets[0].__custom_meta.prefix).concat(t.yLabel.toLocaleString()).concat(e.datasets[0].__custom_meta.suffix)}}}),o.options.responsive=!0,ftfHelpers.colorPalettes[s.dataset.colorScheme]&&o.data.datasets.forEach(function(t,e){t.hoverBorderWidth=4,t.hoverBorderColor=ftfHelpers.pSBC(-.05,ftfHelpers.invertColor(ftfHelpers.colorPalettes[s.dataset.colorScheme][i+3][e])),t.borderWidth=4});break;case"pie":case"doughnut":case"polarArea":for(var u,p=0;p<i;p++){o.data&&o.data.datasets[p]&&(u=void 0,u=ftfHelpers.colorPalettes[s.dataset.colorScheme][e.length]?ftfHelpers.colorPalettes[s.dataset.colorScheme][e.length]:ftfHelpers.colorPalettes[s.dataset.colorScheme][Object.keys(ftfHelpers.colorPalettes[s.dataset.colorScheme]).length-3],o.data.datasets[p].backgroundColor=u,o.data.datasets[p].hoverBorderColor=u.map(function(t){return ftfHelpers.pSBC(-.05,ftfHelpers.invertColor(t))}),o.data.datasets[p].hoverBorderWidth=4,o.data.datasets[p].borderWidth=4)}o.options.tooltips={callbacks:{title:function(t,e){return e.labels[t[0].index]},label:function(t,e){return e.datasets[0].__custom_meta.prefix+parseInt(e.datasets[0].data[t.index]).toLocaleString()+e.datasets[0].__custom_meta.suffix}}};break;case"radar":for(var h,b=0;b<i;b++){o.data&&o.data.datasets[b]&&(h=void 0,h=ftfHelpers.colorPalettes[s.dataset.colorScheme][i]?ftfHelpers.colorPalettes[s.dataset.colorScheme][i]:ftfHelpers.colorPalettes[s.dataset.colorScheme][Object.keys(ftfHelpers.colorPalettes[s.dataset.colorScheme]).length-3],o.data.datasets[b].backgroundColor=ftfHelpers.convertHex(h[b],20),o.data.datasets[b].borderColor=ftfHelpers.convertHex(h[b],40),o.data.datasets[b].hoverBorderColor=ftfHelpers.convertHex(ftfHelpers.pSBC(-.05,ftfHelpers.invertColor(h[b])),40),o.data.datasets[b].hoverBorderWidth=4,o.data.datasets[b].borderWidth=4)}o.options.tooltips={callbacks:{title:function(t,e){return e.labels[t[0].index]},label:function(t,e){return e.datasets[0].__custom_meta.prefix+parseInt(e.datasets[0].data[t.index]).toLocaleString()+e.datasets[0].__custom_meta.suffix}}}}var g,m,v,y,S,_=new Chart(s,o);ftfHelpers.isAdmin()||(g=function(){-1<y&&S.controller.removeHoverStyle(S.data[y],0,y)},m=function(){S.controller.setHoverStyle(S.data[y],0,y),_.render()},v=function(){g(),y=(y+1)%S.data.length,m()},y=-1,S=_.getDatasetMeta(0),s.addEventListener("focus",function(){(-1===y?v:m)()}),s.addEventListener("blur",function(){g(),_.render()}),s.addEventListener("keydown",function(t){"ArrowRight"===t.key?v():"ArrowLeft"===t.key&&(g(),y=(y||S.data.length)-1,m())}))},ftfHelpers.isAdmin=function(){var t=document.getElementsByClassName("wp-admin");return t&&t.length},ready(function(){var t=document.getElementsByClassName("ftf-dataviz-chart");Array.from(t).forEach(function(t){ftfHelpers.renderChart(t)})});
//# sourceMappingURL=chartjs.min.js.map
